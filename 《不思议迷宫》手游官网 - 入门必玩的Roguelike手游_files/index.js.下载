$(function(){
	//轮播图
	var swiper=new Swiper('.swiper-container-one',{
		loop:true,//循环
		autoplay:3000,//3秒切换
		autoplayDisableOnInteraction:false,//重新启动autoplay
		speed:1000,//速度
		//effect:'fade',//效果
		onlyExternal:true,//禁止拖动
		pagination:'.swiper-pagination-one',//分页
		paginationClickable:true,//分页点击
		preventClicks:false,//默认true(超链接跳转)
	})
	//首页新闻切换
	var swiper2=new Swiper('.swiper-container-two',{
		loop:true,//循环
		speed:1000,//速度
		direction:'vertical',//竖版
		onlyExternal:true,//禁止拖动
		preventClicks:false,//默认true(超链接跳转)
		onSlideChangeStart:function(swiper){
	    	$('.main_news_page span:nth-child(1)').text(swiper.realIndex+1);
	    }
	})
	$('.main_news_page span:nth-child(2)').text($('.swiper-container-two .swiper-slide').length-2);
	$('.icon_news_prev').on('click',function(){
		swiper2.slidePrev();
	})
	$('.icon_news_next').on('click',function(){
		swiper2.slideNext();
	})
	//搜索框
	$('.main_search input').focus(function(){
		$('.main_search_list').addClass('focus');
	});
	$('.main_search_list .icon_close').on('click',function(){
		$('.main_search_list').removeClass('focus');
	})
	//排行榜
	var flag=true;
	$('.main_rank_choose input,.main_rank_choose i').on('click',function(event){
		//取消事件冒泡  
        event.stopPropagation();
		if(flag){
			$('.main_rank_choose').addClass('rules');
			$('.main_rank_choose ul').removeClass('hid').addClass('fadeInDown');
			flag=false;
		}else{
			$('.main_rank_choose').removeClass('rules');
			$('.main_rank_choose ul').addClass('hid').removeClass('fadeInDown');
			flag=true;
		}
	})
	$('.main_rank_choose ul li').on('click',function(){
		$('.main_rank_choose input').val($(this).text());
		$('.main_rank_choose input').data("code", $(this).data("code"));
		$('.main_rank_choose ul').addClass('hid').removeClass('fadeInDown');
		$('.main_rank_choose').removeClass('rules');
		getRank();
		flag=true;
	}) 
    //点击空白处隐藏弹出层，下面为滑动消失效果和淡出消失效果。
    $(document).click(function(event){
        var _con = $('.main_rank_choose ul');//设置目标区域
        if(!_con.is(event.target)&&_con.has(event.target).length===0){
			$('.main_rank_choose ul').addClass('hid').removeClass('fadeInDown');
			$('.main_rank_choose').removeClass('rules');
			flag=true;
        }
    });
	//冈布奥图鉴
	$('.swiper-container-three .swiper-slide .illustrated_camp_gba ul li:nth-child(1)').addClass('active');
	$('.illustrated_tab a').on('click',function(){
		var _index_tab=$('.illustrated_tab a').index(this);
		$('.illustrated_tab').addClass('hid').removeClass('fadeInlong2');
		$('.illustrated_details').removeClass('hid').addClass('fadeInlong');
		swiper3.update();
		swiper3.slideTo(_index_tab,10);
		if(_index_tab==0){
			$('.illustrated_prev').addClass('hid');
			$('.illustrated_next').removeClass('hid');
		}else if(_index_tab==3){
			$('.illustrated_prev').removeClass('hid');
			$('.illustrated_next').addClass('hid');
		}else{
			$('.illustrated_prev,.illustrated_next').removeClass('hid');
		}
	})
	var _index=0;
	var main_camp_name=['奥鲁维之刃','卡纳斯的启示','游荡者之歌','深渊的咆哮'];
	var swiper3=new Swiper('.swiper-container-three',{
		loop:false,//不循环
		speed:1000,//速度
		effect:'fade',//效果
		onlyExternal:true,//禁止拖动
		preventClicks:false,//默认true(超链接跳转)
		onSlideChangeStart:function(swiper){
			_index=swiper.activeIndex;
			$('.main_camp_name').text(main_camp_name[_index]);
			if(_index==0){
				$('.illustrated_prev').addClass('hid');
				$('.illustrated_next').removeClass('hid');
			}else if(_index==3){
				$('.illustrated_prev').removeClass('hid');
				$('.illustrated_next').addClass('hid');
			}else{
				$('.illustrated_prev,.illustrated_next').removeClass('hid');
			}
	    }
	})
	$('.illustrated_camp_gba ul li').on('click',function(){
		$(this).addClass('active').siblings().removeClass('active');
		$('.illustrated_camp_'+_index+' img').attr('src',$(this).find('img').attr('src'));
		$('.illustrated_camp_'+_index+' p').text($(this).find('.illustrated_small_gba_mask p span').text());
	})
	$('.illustrated_prev').on('click',function(){
		swiper3.slidePrev();
	})
	$('.illustrated_next').on('click',function(){
		swiper3.slideNext();
	})
	//返回
	$('.illustrated_details .btn_return').on('click',function(){
		$('.illustrated_tab').removeClass('hid').addClass('fadeInlong2');
		$('.illustrated_details').addClass('hid').removeClass('fadeInlong');
	})
	//同人站
	var swiper4=new Swiper('.swiper-container-four',{
		loop:true,//循环
		speed:1000,//速度
		autoplay:3000,//3秒切换
		autoplayDisableOnInteraction:false,//重新启动autoplay
		onlyExternal:true,//禁止拖动
		pagination:'.swiper-pagination-four',//分页
		paginationClickable:true,//分页点击
		preventClicks:false,//默认true(超链接跳转)
	})
	//同人站切换
	$('.tr_choose a').on('click',function(){
		var tr_index=$('.tr_choose a').index(this);
		$(this).addClass('active').siblings().removeClass('active');
		$('.tr_tab .tr_img_show').eq(tr_index).removeClass('hid').addClass('fadeInDown').siblings().addClass('hid').removeClass('fadeInDown');
	})
	//游戏特色
	var swiper5=new Swiper('.swiper-container-five',{
		loop:true,//循环
		speed:1000,//速度
		autoplay:3000,//3秒切换
		autoplayDisableOnInteraction:false,//重新启动autoplay
		onlyExternal:true,//禁止拖动
		pagination:'.swiper-pagination-five',//分页
		paginationClickable:true,//分页点击
		onlyExternal:true,//禁止拖动
	    slidesPerView:3,
	    prevButton:'.swiper_prev',
		nextButton:'.swiper_next',
		preventClicks:false,//默认true(超链接跳转)
	});
	//二维码切换
	$('.footer_er_tab a').on('click',function(){
		var _er_index=$('.footer_er_tab a').index(this);
		$(this).addClass('active').siblings().removeClass('active');
		$('.bottom_er img').eq(_er_index).removeClass('hid').addClass('fadeInDown').siblings().addClass('hid').removeClass('fadeInDown');
	})
	//联系客服
	$('.contact-customer-service').on('click',function(){
		$('.mask,.pop-kf').fadeIn();
	})
	$('.mask').on('click',function(){
		$('.mask,.pop-kf').fadeOut();
	})
	//视频
	$('.btn-video').on('click',function(){
		$('.mask2,.video').fadeIn();
		document.getElementById('video').play();
	})
	$('.mask2').on('click',function(){
		$('.mask2,.video').fadeOut();
		document.getElementById('video').pause();
	})
	//联动福利
    var activity_url = '//activity.leiting.com';
	var gift_loaded = false;
	var data='2020-02-08 23:59:59';
    if(new Date().getTime() > new Date(data.replace(/-/g,'/')).getTime()) {
        $('.btn_combine').hide();
    }

    if(LT_Model.getCookie('elona_gumballs') != '') {
        $.ajax({
            jsonp:'jsonpcallback',
            dataType:'jsonp',
            url: activity_url+'/elona/202001/h5/index.php?act=data&game=gumballs',
            success: function(data) {
                if(data.status==1) {
                    gift_loaded = true;
                    $('#award').val(data.code);
                }
            }
        })
    }

	$('.btn_combine ').on('click', function() {
	    if(gift_loaded) {
            $('.mask_time,.pop_time').fadeIn();
            return;
        }

		$(window).phone_login({
			url: activity_url+'/common/message/common.php?act=sendPhoneCode&type=8',
			id: 'activity',
			game_type: 'gumballs',
			callback_url: activity_url+'/elona/202001/h5/index.php?act=login&game=gumballs',
			callback: function(data) {
				$('.LT_Login').remove();
				$('#LT_phone_login_css').remove();
				$('#LT_getCode').empty().text('获取验证码').removeClass('hui');
				//兑换码
				$('#award').val(data.code);
				gift_loaded = true;
				$('.mask_time,.pop_time').fadeIn();
			}
		});
	});
	$('.btn_timec').on('click', function() {
		$('.mask_time,.pop_time').fadeOut();
	});
	//复制
	var clip=new Clipboard('.copy');
	clip.on('success',function(e) {
		e.clearSelection();
		alert('复制成功。');
	});
	clip.on('error',function(e) {
		alert('复制失败,请手动复制。');
	});
})
